[
  {"cmd": "comment", "text": "Variables with Mash Test"},
  {"cmd": "comment", "text": "Tests using variables to control mash parameters"},
  {"cmd": "comment", "text": ""},
  {"cmd": "comment", "text": "Initialize variables for mash duration"},
  {"cmd": "set", "var": "mash_duration", "value": 1000},
  {"cmd": "set", "var": "hold_time", "value": 25},
  {"cmd": "set", "var": "wait_time", "value": 25},
  {"cmd": "set", "var": "counter", "value": 0},
  {"cmd": "comment", "text": ""},
  {"cmd": "comment", "text": "Test 1: Mash with variable duration"},
  {"cmd": "mash", "buttons": ["A"], "duration_ms": "$mash_duration", "hold_ms": "$hold_time", "wait_ms": "$wait_time"},
  {"cmd": "wait", "ms": 500},
  {"cmd": "comment", "text": ""},
  {"cmd": "comment", "text": "Test 2: Loop with increasing mash speed"},
  {"cmd": "set", "var": "speed_test", "value": 50},
  {"cmd": "while", "left": "$speed_test", "op": ">", "right": 10},
    {"cmd": "comment", "text": "Mash with current speed settings"},
    {"cmd": "mash", "buttons": ["B"], "duration_ms": 500, "hold_ms": "$speed_test", "wait_ms": "$speed_test"},
    {"cmd": "wait", "ms": 300},
    {"cmd": "comment", "text": "Decrease timing to increase speed"},
    {"cmd": "add", "var": "speed_test", "value": -10},
  {"cmd": "end_while"},
  {"cmd": "comment", "text": ""},
  {"cmd": "comment", "text": "Test 3: Conditional mashing based on counter"},
  {"cmd": "set", "var": "counter", "value": 0},
  {"cmd": "while", "left": "$counter", "op": "<", "right": 3},
    {"cmd": "comment", "text": "Mash A three times"},
    {"cmd": "mash", "buttons": ["A"], "duration_ms": 500},
    {"cmd": "wait", "ms": 200},
    {"cmd": "add", "var": "counter", "value": 1},
  {"cmd": "end_while"},
  {"cmd": "comment", "text": ""},
  {"cmd": "comment", "text": "Test 4: Use expression for duration (if counter > 2)"},
  {"cmd": "if", "left": "$counter", "op": ">=", "right": 3},
    {"cmd": "comment", "text": "Counter reached 3, do a long mash"},
    {"cmd": "mash", "buttons": ["X"], "duration_ms": 2000},
  {"cmd": "end_if"},
  {"cmd": "comment", "text": ""},
  {"cmd": "comment", "text": "Variable tests complete!"}
]
